# GPT-2 中文体育新闻生成项目 📝

本项目基于 Hugging Face 的 `transformers` 库，使用预训练的中文 GPT-2 模型 (`uer/gpt2-chinese-cluecorpussmall`) 在自定义的体育新闻数据集上进行微调，旨在创建一个能够根据给定提示（Prompt）生成连贯、风格一致的体育新闻稿的模型。

## ✨ 项目特点

- **模型微调**: 提供完整的脚本，用于在您自己的中文数据集上微调 GPT-2 模型。
- **文本生成**: 提供一个独立的脚本，用于加载微调后的模型并进行交互式文本生成。
- **高度可定制**: 您可以轻松替换自己的数据集、调整训练参数和修改生成逻辑。
- **环境友好**: 提供了详细的环境配置步骤，支持 Conda 和 pip。

## 🚀 快速开始

### 1. 环境配置

建议使用 Conda 创建一个独立的 Python 环境来管理项目依赖。

```bash
# 1. 克隆本项目仓库
git clone [https://github.com/你的用户名/你的仓库名.git](https://github.com/你的用户名/你的仓库名.git)
cd 你的仓库名

# 2. 创建并激活 Conda 环境 (推荐使用 Python 3.10 或 3.11)
conda create -n gpt2_env python=3.10
conda activate gpt2_env

# 3. 安装核心依赖
# (我们指定了 numpy 版本以避免潜在的兼容性问题)
pip install transformers torch datasets accelerate numpy==1.26.4

# 如果您有 NVIDIA GPU 并希望使用 CUDA 加速，请确保安装了相应版本的 PyTorch
# 可以从 PyTorch 官网 ([https://pytorch.org/get-started/locally/](https://pytorch.org/get-started/locally/)) 获取精确的安装命令
```

### 2. 数据准备

将你的训练数据集命名为 `train.json` 并放置在项目的根目录下。数据集的格式应该是一个 JSON 数组，其中每个元素都是一篇新闻稿的字符串。

**`train.json` 文件格式示例:**
```json
[
    "第一篇文章的正文内容...",
    "第二篇文章的正文内容...",
    "第三篇文章的正文内容..."
]
```

### 3. 模型训练

准备好数据后，运行训练脚本来微调模型。

```bash
python train.py
```
训练过程可能需要一些时间，具体取决于你的数据集大小和硬件性能。训练完成后，微调好的模型和分词器将被保存在 `./gpt2-sports-finetuned-final` 目录下。

### 4. 文本生成

使用 `generate.py` 脚本来加载你训练好的模型并生成新的新闻稿。

```bash
# 运行生成脚本
python generate.py
```
你可以直接在 `generate.py` 文件中修改 `prompt` 变量来控制新闻稿的开头。

```python
# 在 generate.py 中修改这一行
prompt = "在今天凌晨结束的一场关键的篮球比赛中，" 
```

## 💡 生成示例

**输入提示:**
```
在今天凌晨结束的一场关键的篮球比赛中，
```

**模型可能生成的输出:**
```
在今天凌晨结束的一场关键的篮球比赛中，战胜魔术队？是否可以说，这场球给了我们不同的感觉。这种场面不是一个球员能决定的，而是需要有人去执行的，就像乔丹和克里斯-波什两位明星教练，每晚都会带着一些对手，一起上演精彩扣篮大赛。所以，对于这支勇士来说，当他们面临选秀权交易问题时，我想这应该更加注重球风的改变。我知道我必须要从中寻找答案，或许，我能够成为一名成熟的球员，但是我的身体已经接近康复健康了。我希望我可以做自己擅长的事情。(休斯敦华夏时报火山鸟)湖人vs雄鹿：湖人是一支强攻狂们只看见凯文的最后时刻新浪体育讯北京时间1月21日，超音速联盟洛杉矶湖人客场100-99击败了森林狼。全场比赛湖人89-87落后对手，科比拿下了24分10个篮板5次助攻。赛后湖人主帅菲利普-桑德斯表示：很高兴能有今天的比赛能让球迷享受到他们的激情，这种感觉确实非常棒。这是每一个球迷都梦寐以求的一场好比赛，只有每一个球队才能创造出这样的惊喜。你也许还会回想起今年夏天，那真是太阳和活塞的比赛。尽管科比曾说过他的状态并没有什么太大意义，不过湖人队最终仍然没有放弃的原因，就是湖人队一直很在乎自己的比赛表现。目前对阵小牛输掉比赛之后，老鹰队却表现得非常积极。主帅里弗斯打算采用其他方式让球队得到胜利，这样他们就能得到比赛的平衡。老鹰总裁约翰-沃尔在上周四告诉《洛杉矶邮报》：我觉得你最重要的任务，就是保持在客场赢球的状态，不仅是让你得到一切。我想这对我们来说也会是一件好事情，我们总是能够抓住每一次机会去取得胜利。(春水方生)这是本届东部季后赛第4轮新浪体育讯北京时间2月25日，湖人主场迎战奇才，奇才坐镇主场，以116-110险胜对手。双方此役各进制2分。猛龙95-爵士86（点击观看视频集锦）猛龙连续6战皆负。奇才(26-36)四连胜终止。贾维尔-麦基拿下16分9个篮板，马库斯-坎比17分、8次助攻，泰勒-钱宁顿13分12个篮板，杰拉德-亨特13分7次助攻。热火(18-15)二连败终止。马。
```

